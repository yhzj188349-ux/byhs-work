<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>订单详情 - B站会员购</title>
  <!-- Tailwind CSS v3 -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Font Awesome -->
  <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <style>
    body {
      font-family: 'PingFang SC', 'Microsoft YaHei', sans-serif;
      background-color: #f5f5f5;
      min-height: 100vh;
    }
    
    .order-container {
      background: white;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.05);
      padding: 1.5rem;
      margin: 1.5rem;
    }
    
    .status-badge {
      display: inline-block;
      padding: 0.25rem 0.75rem;
      border-radius: 9999px;
      font-size: 0.875rem;
      font-weight: 500;
    }
    
    .status-paid {
      background-color: #ecfdf5;
      color: #059669;
    }
    
    .product-item {
      border-bottom: 1px solid #e5e7eb;
      padding: 1rem 0;
    }
    
    .product-item:last-child {
      border-bottom: none;
    }
    
    .text-primary {
      color: #fb7299;
    }
  </style>
</head>
<body>
  <!-- 顶部导航栏 -->
  <header class="bg-pink-500 text-white sticky top-0 z-50">
    <div class="container mx-auto px-4 py-3 flex items-center justify-between">
      <div class="flex items-center space-x-4">
        <button onclick="goBack()" class="text-white">
          <i class="fa fa-arrow-left"></i>
        </button>
        <h1 class="text-xl font-bold">订单详情</h1>
      </div>
      <div class="flex items-center space-x-4">
        <a href="./商城首页/index.html" class="text-white">
          <i class="fa fa-home"></i>
        </a>
      </div>
    </div>
  </header>

  <main class="container mx-auto">
    <div class="order-container">
      <!-- 订单状态 -->
      <div class="flex justify-between items-center mb-6">
        <div>
          <h2 class="text-lg font-semibold">订单号：<span id="order-id">加载中...</span></h2>
          <p class="text-gray-500 text-sm mt-1">下单时间：<span id="order-date">加载中...</span></p>
        </div>
        <span class="status-badge status-paid">已支付</span>
      </div>
      
      <!-- 收货信息 -->
      <div class="border border-gray-200 rounded-lg p-4 mb-6">
        <div class="flex items-start">
          <i class="fa fa-map-marker-alt text-primary mt-1 mr-3"></i>
          <div>
            <h3 class="font-medium">收货信息</h3>
            <p class="text-gray-600 mt-1" id="shipping-info">加载中...</p>
          </div>
        </div>
      </div>
      
      <!-- 商品列表 -->
      <div class="mb-6">
        <h3 class="font-semibold mb-4">商品信息</h3>
        <div id="product-list">
          <!-- 商品项将通过JavaScript动态生成 -->
        </div>
      </div>
      
      <!-- 订单金额 -->
      <div class="border-t border-gray-200 pt-4">
        <h3 class="font-semibold mb-3">订单金额</h3>
        <div class="space-y-2">
          <div class="flex justify-between">
            <span class="text-gray-600">商品总额</span>
            <span id="product-total">¥0.00</span>
          </div>
          <div class="flex justify-between">
            <span class="text-gray-600">运费</span>
            <span class="text-green-600">免运费</span>
          </div>
          <div class="flex justify-between pt-2 border-t border-gray-300 font-semibold">
            <span>实付金额</span>
            <span class="text-primary text-lg" id="amount-paid">¥0.00</span>
          </div>
        </div>
      </div>
    </div>
    
    <!-- 支付信息 -->
    <div class="order-container mb-6">
      <h3 class="font-semibold mb-4">支付信息</h3>
      <div class="grid grid-cols-2 gap-4">
        <div>
          <p class="text-gray-500 text-sm">支付方式</p>
          <p class="font-medium" id="payment-method">加载中...</p>
        </div>
        <div>
          <p class="text-gray-500 text-sm">支付时间</p>
          <p class="font-medium" id="payment-time">加载中...</p>
        </div>
      </div>
    </div>
  </main>

  <script>
    // 返回上一页
    function goBack() {
      window.history.back();
    }
    
    // 获取URL参数
    function getUrlParameter(name) {
      name = name.replace(/[\[]/, '\\[').replace(/[\]]/, '\\]');
      var regex = new RegExp('[\\?&]' + name + '=([^&#]*)');
      var results = regex.exec(window.location.search);
      return results === null ? '' : decodeURIComponent(results[1].replace(/\+/g, ' '));
    }
    
    // 从localStorage加载地址数据
    function loadAddress() {
      try {
        const addressData = localStorage.getItem('addressInfo');
        if (addressData) {
          return JSON.parse(addressData);
        }
      } catch (error) {
        console.error('解析地址数据失败:', error);
      }
      // 返回默认地址信息
      return {
        name: '张三',
        phone: '138****8888',
        detail: '北京市朝阳区某某街道某某小区1号楼101室'
      };
    }
    
    // 页面加载完成后显示订单信息
    document.addEventListener('DOMContentLoaded', function() {
      // 获取订单信息（实际项目中应该从服务器获取）
      const orderId = getUrlParameter('orderId') || 'ORDER' + new Date().getTime();
      const amount = getUrlParameter('amount') || '99.00';
      const paymentMethod = getUrlParameter('paymentMethod') || '支付宝';
      
      // 显示订单基本信息
      document.getElementById('order-id').textContent = orderId;
      document.getElementById('order-date').textContent = new Date().toLocaleString('zh-CN');
      document.getElementById('amount-paid').textContent = '¥' + amount;
      document.getElementById('product-total').textContent = '¥' + amount;
      document.getElementById('payment-method').textContent = paymentMethod;
      document.getElementById('payment-time').textContent = new Date().toLocaleString('zh-CN');
      
      // 显示收货信息（从localStorage获取）
      const addressInfo = loadAddress();
      document.getElementById('shipping-info').textContent = addressInfo.name + ' ' + addressInfo.phone + ' ' + addressInfo.detail;
      
      // 模拟商品列表数据（实际项目中应该从服务器获取）
      const productList = [
        {
          id: 1,
          name: '初音未来手办',
          image: './商城首页/images/初音未来.jpg',
          price: 89.00,
          quantity: 1,
          attributes: ['样式: 普通版', '尺寸: 15cm']
        },
        {
          id: 2,
          name: '七海阿梓周边',
          image: './商城首页/images/七海阿萨.jpg',
          price: 59.00,
          quantity: 2,
          attributes: ['颜色: 粉色', '尺寸: 均码']
        }
      ];
      
      // 渲染商品列表
      renderProductList(productList);
    });
    
    // 渲染商品列表
    function renderProductList(products) {
      const productListElement = document.getElementById('product-list');
      
      if (products.length === 0) {
        productListElement.innerHTML = '<p class="text-gray-500 text-center py-4">暂无商品信息</p>';
        return;
      }
      
      let productListHTML = '';
      products.forEach(product => {
        productListHTML += `
          <div class="product-item">
            <div class="flex">
              <img src="${product.image}" alt="${product.name}" class="w-16 h-16 object-cover rounded">
              <div class="ml-4 flex-1">
                <h4 class="font-medium text-gray-800">${product.name}</h4>
                <div class="mt-1 flex flex-wrap gap-1">
                  ${product.attributes.map(attr => `<span class="text-xs bg-gray-100 px-2 py-0.5 rounded">${attr}</span>`).join('')}
                </div>
                <div class="flex justify-between items-center mt-2">
                  <span class="text-gray-600">¥${product.price.toFixed(2)}</span>
                  <span class="text-gray-700">x ${product.quantity}</span>
                </div>
              </div>
              <div class="font-medium text-gray-800">¥${(product.price * product.quantity).toFixed(2)}</div>
            </div>
          </div>
        `;
      });
      
      productListElement.innerHTML = productListHTML;
    }
  </script>
</body>
</html>